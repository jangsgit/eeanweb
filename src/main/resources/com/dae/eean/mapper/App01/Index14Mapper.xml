<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- mapper >> interface 매핑 : id 값 중요 (interface 메소드) -->
<mapper namespace="com.dae.eean.Mapper.App01.Index14Mapper">



    <select id="SelectCheckMisnum" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da024 WITH (NOLOCK) where misdate = #{misdate} and cltcd=#{cltcd} and misgubun = #{misgubun} and isnull(pmodel,'') <> 'AS' and ( Len(isnull(makflag,'')) = 0 OR makflag = '0')    order by misdate, misnum     ]]>
    </select>

    <select id="SelectCheckMisnumJupsu" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da024 WITH (NOLOCK) where misdate = #{misdate} and cltcd=#{cltcd} and misgubun = #{misgubun} and isnull(pmodel,'') = 'AS' and ( Len(isnull(makflag,'')) = 0 OR makflag = '0')    order by misdate, misnum     ]]>
    </select>

    <select id="SelectCheckMisnumMkflag" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da024 WITH (NOLOCK) where misdate = #{misdate} and isnull(pmodel,'') <> 'AS'     order by misdate, misnum desc     ]]>
    </select>

    <select id="SelectCheckMisnumMkflagJupsu" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da024 WITH (NOLOCK) where misdate = #{misdate} and isnull(pmodel,'') = 'AS' and left(misnum,1) = '5'    order by misdate, misnum desc     ]]>
    </select>

    <select id="SelectCheckMisnumOrd" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da024 WITH (NOLOCK) where misdate = #{omisdate} and cltcd=#{cltcd} and misgubun = #{misgubun} and isnull(pmodel,'') <> 'AS' order by misdate, misnum     ]]>
    </select>

    <select id="SelectCheckMisnumWish" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da025 WITH (NOLOCK) where misdate = #{misdate} and cltcd=#{cltcd}  and misgubun = #{misgubun}  and ( Len(isnull(makflag,'')) = 0 OR makflag = '0')    order by misdate, misnum     ]]>
    </select>

    <select id="SelectCheckMisnumWishMkflag" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select top 1 misnum  from tb_da025 WITH (NOLOCK) where misdate = #{misdate}     order by misdate, misnum desc   ]]>
    </select>

    <select id="SelectCheckJpum024" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[  select  seq, uamt, qty  from tb_da024 WITH (NOLOCK) where pcode=#{pcode} and misdate = #{misdate} and misnum=#{misnum}   and misgubun = #{misgubun} and ( Len(isnull(makflag,'')) = 0 OR makflag = '0')   order by misdate, misnum     ]]>
    </select>

    <select id="SelectCheckJpum026" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[  select  seq, uamt, qty  from tb_da026 WITH (NOLOCK) where pcode=#{pcode} and misdate = #{misdate} and misnum=#{misnum}   and misgubun = #{misgubun} and ( Len(isnull(makflag,'')) = 0 OR makflag = '0')   order by misdate, misnum     ]]>
    </select>

    <select id="SelectMaxMisnum" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select  max(misnum)  from tb_da023  WITH (NOLOCK) where misdate = #{misdate}      ]]>
    </select>

    <select id="SelectTrackMisnum" parameterType="String" resultType="Integer">
        <![CDATA[  select  mnum  from tb_da024_mnum  WITH (NOLOCK) where misdate = #{misdate}      ]]>
    </select>


    <insert id="InsertTrackMisnum" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA024_MNUM ( misdate, mnum ) values  ( #{misdate}, #{mnum} )
    </insert>


    <update id="UpdateTrackMisnum" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        update TB_DA024_MNUM  set  mnum  = #{mnum} where misdate = #{misdate}
    </update>


    <select id="SelectMaxMisnumWish" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select  max(misnum)  from tb_da025  WITH (NOLOCK) where misdate = #{misdate}      ]]>
    </select>

    <select id="SelectMaxSeq" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select  max(seq)  from tb_da024 WITH (NOLOCK) where misdate = #{misdate} and misnum = #{misnum} and cltcd = #{cltcd} and misgubun =#{misgubun}   ]]>
    </select>

    <select id="SelectMaxSeqWish" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" resultType="String">
        <![CDATA[  select  max(seq)  from tb_da026 WITH (NOLOCK) where misdate = #{misdate} and misnum = #{misnum} and cltcd = #{cltcd} and misgubun =#{misgubun}   ]]>
    </select>

    <select id="SelectDa026Detail" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[  select omisdate , omisnum , oseq , misdate, misnum, seq, cltcd, misgubun
                   from tb_da026 WITH (NOLOCK)
                   where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq}
                     AND ISNULL(omisdate  ,'') <> ''  ]]>
    </select>

    <select id="SelectDa024Detail" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[  select  isnull(uamt,0) as uamt, samt, addamt, amt
                   from tb_da024 WITH (NOLOCK)
                   where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq}
                   and misgubun = #{misgubun}    ]]>
    </select>

    <select id="SelectDa026Detail02" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[  select  isnull(uamt,0) as uamt, samt, addamt, amt
                   from tb_da026 WITH (NOLOCK)
                   where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq}
                        ]]>
    </select>

    <select id="SelectDa024List"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">

        <![CDATA[ select B.cltcd as cltcd,
                      Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate,
                      B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      B.unsongnum as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,    B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime , CONVERT(CHAR(19),B.misdatetime,20) as misdatetime, 0 as jqty,
                      B.userid, B.usernm
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                  where  B.cltcd = #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                    and isnull(B.pname, '') not in ('AS', '유상')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>
    </select>

    <select id="SelectDa024ListAS"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">

        <![CDATA[ select B.cltcd as cltcd,
                      Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate,
                      B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.unsongnum, isnull( D.unsongnum, '')) as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,    B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime , CONVERT(CHAR(19),B.misdatetime,20) as misdatetime, 0 as jqty,
                      B.userid, B.usernm
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                       LEFT JOIN as_jupsu D ON B.misdate = D.misdate and B.misnum = D.misnum
                  where  B.cltcd = #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>
    </select>

    <select id="SelectDa024ListLike"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">


        <![CDATA[ select B.cltcd as cltcd,
                      Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2)  as misdate,
                      B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      B.unsongnum as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime ,  CONVERT(CHAR(19),B.misdatetime,20) as misdatetime , 0 as jqty,
                      B.userid, B.usernm
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                  where B.CLTCD Like concat('%',#{cltcd},'%')
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                    and isnull(B.pname, '') not in ('AS', '유상')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa024ListLikeAS"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">


        <![CDATA[
                WITH JUPSUDATA AS (
                    SELECT misdate, misnum, unsongnum
                    FROM as_jupsu
                    WHERE misdate BETWEEN #{frdate} and #{todate}
                )

                select B.cltcd as cltcd,
                      Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2)  as misdate,
                      B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.unsongnum, isnull(D.unsongnum,'')) as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime ,  CONVERT(CHAR(19),B.misdatetime,20) as misdatetime , 0 as jqty,
                      B.userid, B.usernm
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                       LEFT JOIN JUPSUDATA D ON B.misdate = D.misdate and B.misnum = D.misnum
                  where B.CLTCD Like concat('%',#{cltcd},'%')
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa024ListLikeJupsu"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">


        <![CDATA[

                WITH JUPSUDATA AS (
                    SELECT misdate, misnum, unsongnum
                    FROM as_jupsu
                    WHERE misdate BETWEEN #{frdate} and #{todate}
                )

                select B.cltcd as cltcd,
                      Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2)  as misdate,
                      B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      B.unsongnum as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime ,  CONVERT(CHAR(19),B.misdatetime,20) as misdatetime , 0 as jqty,
                      CONVERT(CHAR(19),B.devdatetime,20) as devdatetime ,
                      B.userid, B.usernm
                  from  TB_DA024 B WITH (NOLOCK)
                        LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                       LEFT JOIN JUPSUDATA D ON B.misdate = D.misdate and B.misnum = D.misnum
                  where B.CLTCD Like concat('%',#{cltcd},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.userid, '') Like #{userid}
                    AND B.pmodel = 'AS'
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa024ListJang"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">


        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      B.unsongnum as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   B.PERNM as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime ,  DBO.DF_TB_PCODE_JQTY(B.pcode,  #{jfrdate},  #{jtodate})  as jqty
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                  where   B.cltcd = #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>
    </select>

    <select id="SelectDa024ListLikeJang"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      B.unsongnum as unsongnum,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   B.pernm as pernm,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime ,  DBO.DF_TB_PCODE_JQTY(B.pcode,  #{jfrdate},  #{jtodate})  as jqty
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                  where  B.cltcd Like concat('%',#{cltcd},'%')
                    AND isnull(B.inperid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.devflag, '0') Like concat('%',#{devflag},'%')
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  ORDER BY  B.misdate desc, B.misnum, B.seq
        ]]>

    </select>


    <select id="SelectDa024ListDel"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.makflag, '0') as makflag,
                      B.unsongnum as unsongnum,
                      B.deluser,
                      B.deluserid,
                      B.amt, A.acorp, pbonsa, pmodel, pcolor , D.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   D.pernm ,  B.deltime, B.fixdatetime
                  from  TB_DA024_DEL B WITH (NOLOCK) ,
                      cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON  A.abonsadam1 = D.PERID
                  where   B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
                    AND A.acorp1 + CAST(A.acorp2 as varchar) Like concat('%',#{cltcd},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.pcode, '') Like concat('%',#{pcode},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpb_gubn},'%')
                  ORDER BY B.misdate desc, B.misnum, B.seq
        ]]>

    </select>


    <select id="SelectDa024ListMakflag"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.makflag, '0') as makflag,
                      B.unsongnum as unsongnum,
                      B.usernm,
                      B.userid,
                      B.amt, A.acorp, pbonsa, pmodel, pcolor , D.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag,isnull(B.devflag,'0') as devflag,   D.pernm ,    B.misdatetime
                  from  TB_DA024 B WITH (NOLOCK) ,
                      cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON  A.abonsadam1 = D.PERID
                  where   B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
                    AND A.acorp1 + CAST(A.acorp2 as varchar) Like concat('%',#{cltcd},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.misgubun, '') Like concat('%',#{misgubun},'%')
                    AND Isnull(B.pcode, '') Like concat('%',#{pcode},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpb_gubn},'%')
                    and isnull(B.makflag,'0')  = '0'
                  ORDER BY B.misdate desc, B.misnum, B.seq
        ]]>

    </select>

    <!-- 한개 업체 당일 전표일자로 출력  -->
    <select id="SelectDa024ListPrt"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        select B.cltcd as cltcd,  substring(B.misdate, 5,2)+ '.' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
            (case when len(isnull(B.remarkaa,'')) > 0 then B.remarkaa  when len(isnull(B.remarkbb,'')) > 0 then B.remarkbb else '' END ) AS remark,
            substring(B.misdate, 1,4)+ '년 ' + substring(B.misdate, 5,2)+ '월 ' + substring(B.misdate, 7,2) + '일' as misdatetxt,
            substring(CONVERT(VARCHAR, B.fixdatetime, 112), 1,4)+ '년 ' + substring(CONVERT(VARCHAR, B.fixdatetime, 112), 5,2)+ '월 ' + substring(CONVERT(VARCHAR, B.fixdatetime, 112), 7,2) + '일' as fixdatetime,
            B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
            B.amt, A.acorp, B.pbonsa, B.pname + ' (' + B.pmodel + ')' as pmodel, B.pcolor , D.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, D.pernm,
            ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,
            A.acorp, A.asano1 + '-' + A.asano2 + '-' + A.asano3 as asano, A.aname, A.aupte, A.ajong, A.ajuso1 + ' ' + A.ajuso2 as ajuso, A.atelno,
            A.aascode1 + '-' + A.aascode2 as aascodetxt,
            F.acorp as eeacorp, F.asano as eeasano, F.aname as eeaname, F.aupte as eeupte, F.ajong as eeajong, F.ajuso as eeajuso, F.atelno as eeatelno,
            F.eeacodetxt as eeacodetxt
        from  TB_DA024 B WITH (NOLOCK) ,
              JCODE3 K  WITH (NOLOCK) ,
            cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid,
            ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong, ajuso1 + ' ' + ajuso2 as ajuso,
                aascode1 + '-' + aascode2 as eeacodetxt
                 from cif where acorp1 + acorp2 + acorp3 = '0000' ) F
        where B.pcode = K.jkey
        AND B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
        AND B.misdate = #{misdate} and B.misnum = #{misnum}  and B.cltcd = #{cltcd}
        AND B.fixflag = '1'
        ORDER BY  CONVERT(int, K.jbonsa_code_seq), B.pname, pcolor, B.misdate desc, B.misnum, B.seq
    </select>

<!--    <select id="SelectDa024ListPrt"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">-->
<!--          select B.cltcd as cltcd,  substring(B.misdate, 5,2)+ '.' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,-->
<!--                 (case when len(isnull(C.remarkaa,'')) > 0 then C.remarkaa  when len(isnull(C.remarkbb,'')) > 0 then C.remarkbb else '' END ) AS remark,-->
<!--                         substring(B.misdate, 1,4)+ '년 ' + substring(B.misdate, 5,2)+ '월 ' + substring(B.misdate, 7,2) + '일' as misdatetxt,-->
<!--                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,-->
<!--                         B.amt, A.acorp, pbonsa, pmodel, pcolor , D.inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, D.inname as pernm,-->
<!--                         ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,-->
<!--                         A.acorp, A.asano1 + '-' + A.asano2 + '-' + A.asano3 as asano, A.aname, A.aupte, A.ajong, A.ajuso1 + ' ' + A.ajuso2 as ajuso, A.atelno,-->
<!--                         A.aascode1 + '-' + A.aascode2 as aascodetxt,-->
<!--                         F.acorp as eeacorp, F.asano as eeasano, F.aname as eeaname, F.aupte as eeupte, F.ajong as eeajong, F.ajuso as eeajuso, F.atelno as eeatelno,-->
<!--                         F.eeacodetxt as eeacodetxt-->
<!--           from  TB_DA024 B WITH (NOLOCK) ,-->
<!--                 cif A WITH (NOLOCK) Left outer JOIN INSA D ON A.abonsadam1 = D.insano,-->
<!--                 TB_DA023 C WITH (NOLOCK) ,-->
<!--                 ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong, ajuso1 + ' ' + ajuso2 as ajuso,-->
<!--                    aascode1 + '-' + aascode2 as eeacodetxt-->
<!--                    from cif where acorp1 + acorp2 + acorp3 = '0000' ) F-->
<!--           where B.misdate + B.misnum = C.misdate + C.misnum AND B.misgubun = C.misgubun-->
<!--             AND B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)-->
<!--             AND C.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)-->
<!--            AND B.misdate = #{misdate} and B.misnum = #{misnum} and B.cltcd = #{cltcd}-->
<!--            AND B.fixflag = '1'-->
<!--            ORDER BY B.cltcd,  B.misdate, B.misnum, B.seq-->
<!--    </select>-->

    <!-- 한개 업체 당일 전표일자로 출력  -->
<!--    <select id="SelectDa024ListPrtGroup"  parameterType="hashmap"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">-->
<!--        select B.cltcd as cltcd,  B.misdate as misdate, MIN(B.misnum) AS misnum,-->
<!--            (case when len(isnull(C.remarkaa,'')) > 0 then C.remarkaa  when len(isnull(C.remarkbb,'')) > 0 then C.remarkbb else '' END ) AS remark,-->
<!--            substring(B.misdate, 1,4)+ '년 ' + substring(B.misdate, 5,2)+ '월 ' + substring(B.misdate, 7,2) + '일' as misdatetxt,-->
<!--            sum(B.qty) as qty,   sum(B.samt) as samt, sum(B.addamt) as addamt, sum(B.amt) as amt,-->
<!--            A.acorp, ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,-->
<!--            MAX(F.acorp) as eeacorp, MAX(F.asano) as eeasano, MAX(F.aname) as eeaname, MAX(F.aupte) as eeupte,-->
<!--            MAX(F.ajong) as eeajong, MAX(F.ajuso) as eeajuso, MAX(F.atelno) as eeatelno-->
<!--        from  TB_DA024 B WITH (NOLOCK) ,-->
<!--              cif A WITH (NOLOCK) Left outer JOIN INSA D ON A.abonsadam1 = D.insano,-->
<!--              TB_DA023 C WITH (NOLOCK)  ,-->
<!--        ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong, ajuso1 + ' ' + ajuso2 as ajuso-->
<!--        from cif where acorp1 + acorp2 + acorp3 = '0000' ) F-->
<!--        where B.misdate + B.misnum = C.misdate + C.misnum AND B.misgubun = C.misgubun-->
<!--        AND B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)-->
<!--        AND C.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)-->
<!--        AND B.misdate   + B.cltcd in-->
<!--        <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">-->
<!--            #{itemcd}-->
<!--        </foreach>-->
<!--        AND B.fixflag = '1'-->
<!--        Group BY B.cltcd,  B.misdate, A.acorp, C.remarkaa, C.remarkbb-->
<!--        ORDER BY B.cltcd,  B.misdate-->
<!--    </select>-->


    <!-- 전표일자/순번 별로 출력  -->
    <select id="SelectDa024ListPrtGroup"  parameterType="hashmap"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        select B.cltcd as cltcd,  B.misdate as misdate, B.misnum,
            (case when len(isnull(max(B.remarkaa),'')) > 0 then max(B.remarkaa)  when len(isnull(max(B.remarkbb),'')) > 0 then max(B.remarkbb) else '' END ) AS remark,
            substring(B.misdate, 1,4)+ '년 ' + substring(B.misdate, 5,2)+ '월 ' + substring(B.misdate, 7,2) + '일' as misdatetxt,
            sum(B.qty) as qty,   sum(B.samt) as samt, sum(B.addamt) as addamt, sum(B.amt) as amt, MAX(isnull(B.pmodel,'')) as pmodel, MAX(isnull(B.pcolor,'')) as pcolor,
            D.acorp, ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,
            MAX(F.acorp) as eeacorp, MAX(F.asano) as eeasano, MAX(F.aname) as eeaname, MAX(F.aupte) as eeupte,
            MAX(F.ajong) as eeajong, MAX(F.ajuso) as eeajuso, MAX(F.atelno) as eeatelno
        from  TB_DA024 B WITH (NOLOCK)
              LEFT JOIN CIF D ON B.CLTCD = D.acorp1+CAST(D.acorp2 as varchar),
            ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong, ajuso1 + ' ' + ajuso2 as ajuso
            from cif where acorp1 + acorp2 + acorp3 = '0000' ) F
        where  B.misdate + B.misnum + B.seq + B.cltcd in
        <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">
            #{itemcd}
        </foreach>

        Group BY B.cltcd,  B.misdate, B.misnum, D.acorp
        ORDER BY B.misdate desc, B.misnum
    </select>

    <select id="SelectDa024ListDevGroup"  parameterType="hashmap"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        select B.cltcd as cltcd,  B.misdate as misdate, B.misnum,
            substring(B.misdate, 1,4)+ '년 ' + substring(B.misdate, 5,2)+ '월 ' + substring(B.misdate, 7,2) + '일' as misdatetxt,
            sum(B.qty) as qty,   sum(B.samt) as samt, sum(B.addamt) as addamt, sum(B.amt) as amt,
            case when sum(B.qty) = 1 then  MAX(B.pname) else Max(B.pname) + ' 외' + cast(sum(B.qty) - 1 as varchar(100)) + '건' end  as pname,
            A.acorp, max(A.atelno) as atelno, max(ajuso1) + ' ' + max(ajuso2) as ajuso , '안경원입니다.' as remark,
            '안경원입니다! 인수자  서명 부탁드립니다.' as message, isnull(max(B.payflag), '0') AS payflag,
            ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,
            MAX(A.aascode1) + '-' + MAX(A.aascode2) as aascodetxt,
            MAX(F.acorp) as eeacorp, MAX(F.asano) as eeasano, MAX(F.aname) as eeaname, MAX(F.aupte) as eeupte,
            MAX(F.ajong) as eeajong, MAX(F.ajuso) as eeajuso, MAX(F.atelno) as eeatelno,  MAX(F.eeacodetxt) as eeacodetxt, MAX(F.eeatelno) as eeatelno
        from  TB_DA024 B WITH (NOLOCK) ,
            cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid ,
            ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong,
              ajuso1 + ' ' + ajuso2 as ajuso, aascode1 + '-' + aascode2 as eeacodetxt, atelno as eeatelno
            from cif where acorp1 + acorp2 + acorp3 = '0000' ) F
        where  B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
            AND B.misdate + B.misnum + B.cltcd in
            <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">
                #{itemcd}
            </foreach>
            AND isnull(B.devflag, '0') = '1'
        Group BY B.cltcd,  B.misdate, B.misnum, A.acorp
        ORDER BY B.misdate desc, B.misnum
    </select>

    <select id="SelectDa024ListDevJupsuGroup"  parameterType="hashmap"  resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        select  B.as_acorp1 + CAST(B.as_acorp2 as varchar) as cltcd,
            B.as_key1 as misdate, B.as_key2 AS misnum, B.as_model as pmodel, B.as_yumu ,
            substring(B.as_key1, 1,4)+ '년 ' + substring(B.as_key1, 6,2)+ '월 ' + substring(B.as_key1, 9,2) + '일' as misdatetxt,
            sum(isnull(E.qty,0)) as qty,   sum(isnull(E.samt,0)) as samt, sum(isnull(E.addamt,0)) as addamt, sum(isnull(E.amt,0)) as amt,
            case when sum(isnull(E.qty,0)) = 1 then  MAX(isnull(E.pname,'')) when sum(isnull(E.qty,0)) = 0 then '무상'  else Max(isnull(E.pname,'')) + ' 외' + cast(sum(isnull(E.qty,0)) - 1 as varchar(100)) + '건' end  as pname,
            A.acorp as acorp, max(A.atelno) as atelno, max(ajuso1) + ' ' + max(ajuso2) as ajuso , '안경원입니다.' as remark,
            '안경원입니다! 인수자  서명 부탁드립니다.' as message, isnull(max(E.payflag), '0') AS payflag,
            ROW_NUMBER() OVER(ORDER BY (SELECT 1)) AS rownum,
            MAX(A.aascode1) + '-' + MAX(A.aascode2) as aascodetxt,
            MAX(F.acorp) as eeacorp, MAX(F.asano) as eeasano, MAX(F.aname) as eeaname, MAX(F.aupte) as eeupte, MAX(A.agita) as agita,
            MAX(F.ajong) as eeajong, MAX(F.ajuso) as eeajuso, MAX(F.atelno) as eeatelno,  MAX(F.eeacodetxt) as eeacodetxt, MAX(F.eeatelno) as eeatelno
        from  as_jupsu B WITH (NOLOCK)
              LEFT OUTER JOIN TB_DA024 E WITH (NOLOCK) ON B.misdate = E.misdate and B.misnum = E.misnum and E.pmodel= 'AS',
            cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid ,
            ( select acorp, atelno, asano1 + '-' + asano2 + '-' + asano3 as asano, aname, aupte, ajong,
            ajuso1 + ' ' + ajuso2 as ajuso, aascode1 + '-' + aascode2 as eeacodetxt, atelno as eeatelno
            from cif where acorp1 + acorp2 + acorp3 = '0000' ) F
        where   B.as_acorp1 = A.acorp1
            AND B.as_acorp2 = A.acorp2
            AND B.as_key1 + CAST(B.as_key2 AS varchar)  in
        <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">
            #{itemcd}
        </foreach>
        AND isnull(B.as_devflag, '0') = '1'
        Group BY B.as_acorp1, B.as_acorp2,  B.as_key1, B.as_key2, B.as_acorp, B.as_model, B.as_yumu, A.acorp
        ORDER BY B.as_key1 desc, B.as_key2
    </select>

    <select id="SelectDa026List"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                         isnull(B.remarkaa,'') as remarkaa,
                         isnull(B.remarkbb,'') as remarkbb,
                         isnull(B.makflag, '0') as makflag,
                         B.amt, B.acorp, pbonsa, pmodel, pcolor, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.omisdate, B.omisnum, B.oseq , convert(integer, DBO.DF_TB_PCODE_JQTY(B.pcode,  #{jfrdate},  #{jtodate}) ) as jqty, B.userid, B.usernm
           from  TB_DA026 B WITH (NOLOCK)
           where  B.cltcd = #{cltcd}
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
            AND B.misdate between #{frdate} and #{todate}
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
             AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
             and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
             AND Isnull(B.pcode, '') Like concat( #{pcode},'%')
            ORDER BY B.misdate, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa026ListDel"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.makflag, '0') as makflag,
                      B.amt, A.acorp, pbonsa, pmodel, pcolor, D.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, D.pernm,
                      B.omisdate, B.omisnum, B.oseq, B.deltime
                  from  TB_DA026_del B WITH (NOLOCK) ,
                      cif A WITH (NOLOCK) Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid ,
                      jcode3 E WITH (NOLOCK)
                  where  B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
                    AND B.pcode = E.jkey
                    AND A.acorp1 + CAST(A.acorp2 as varchar) Like concat('%',#{cltcd},'%')
                    AND isnull(A.abonsadam1,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(E.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                    AND Isnull(B.pcode, '') Like concat( #{pcode},'%')
                  ORDER BY B.misdate, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa026ListLike"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                          isnull(B.remarkaa,'') as remarkaa,
                          isnull(B.remarkbb,'') as remarkbb,
                           isnull(B.makflag, '0') as makflag,
                         B.amt, B.acorp, pbonsa, pmodel, pcolor, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.omisdate, B.omisnum, B.oseq, convert(integer, DBO.DF_TB_PCODE_JQTY(B.pcode,  #{jfrdate},  #{jtodate}) ) as jqty, B.userid, B.usernm
           from  TB_DA026 B WITH (NOLOCK)
           where B.cltcd Like concat('%',#{cltcd},'%')
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
            AND B.misdate between #{frdate} and #{todate}
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
             AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
             AND Isnull(B.pcode, '') Like concat(   #{pcode},'%')
             and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
            ORDER BY B.misdate, B.misnum, B.seq
        ]]>

    </select>

<!--    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')-->
    <select id="SelectDa024ListPeridGroup"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select count(*) as rownum,  sum(B.qty) as qty,  sum(B.samt) as samt, sum(B.addamt) as addamt,
                         sum(B.amt) as amt,   B.pernm as pernm, B.perid AS perid
           from  TB_DA024 B WITH (NOLOCK)
           where   B.cltcd Like  #{cltcd}
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
            AND B.fixdate between #{frdate} and #{todate}
            AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')

             and isnull(B.pcode,'') Like  #{pcode} + '%'
             AND Len(ISNULL(B.pernm,'')) > 0
            Group BY B.perid,  B.pernm
            ORDER BY  B.pernm
        ]]>

    </select>


<!--    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')-->
    <select id="SelectDa024ListPeridGroupJumun"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select count(*) as rownum,  sum(B.qty) as qty,  sum(B.samt) as samt, sum(B.addamt) as addamt,
                         sum(B.amt) as amt,   B.pernm as pernm, B.perid AS perid
           from  TB_DA024 B WITH (NOLOCK)
           where   B.cltcd Like  #{cltcd}
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
            AND B.misdate between #{frdate} and #{todate}
            AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')

             AND Len(ISNULL(B.pernm,'')) > 0
             and isnull(B.pcode,'') Like  #{pcode} + '%'
            Group BY B.perid,  B.pernm
            ORDER BY  B.pernm
        ]]>

    </select>

    <!--        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,-->
    <!--                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,-->
    <!--                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,-->
    <!--                      isnull(B.remarkaa,'') as remarkaa,-->
    <!--                      isnull(B.remarkbb,'') as remarkbb,-->
    <!--                      isnull(B.unsongnum, isnull(D.unsongnum,'')) as unsongnum,-->
    <!--                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime,  CONVERT(CHAR(19),B.misdatetime,20) as misdatetime-->
    <!--                  from  TB_DA024 B WITH (NOLOCK)-->
    <!--                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)-->
    <!--                       LEFT JOIN as_jupsu D ON B.misdate = D.misdate and B.misnum = D.misnum-->
    <!--                  where    B.cltcd Like    #{cltcd}-->
    <!--                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')-->
    <!--                    AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')-->
    <!--                    AND B.fixdate between #{frdate} and #{todate}-->
    <!--                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')-->
    <!--                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')-->
    <!--                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')-->
    <!--                    AND Len(ISNULL(B.pernm,'')) > 0-->
    <!--                    and isnull(B.pcode,'') Like  #{pcode} + '%'-->
    <!--                  ORDER BY B.pernm, B.fixdate, B.misdate, B.misnum, B.seq-->
    <!--        ]]>-->

    <select id="SelectDa024ListPerid"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">

        exec SP_SelectDa024ListPerid
            #{cltcd, jdbcType=VARCHAR},
            #{perid, jdbcType=VARCHAR},
            #{misgubun, jdbcType=VARCHAR},
            #{frdate, jdbcType=VARCHAR},
            #{todate, jdbcType=VARCHAR},
            #{fixflag, jdbcType=VARCHAR},
            #{makflag, jdbcType=VARCHAR},
            #{pcode, jdbcType=VARCHAR}

    </select>

<!--    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')-->
    <select id="SelectDa024ListPeridJumun"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                      B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                      B.amt, C.acorp, pbonsa, pmodel, pcolor , B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                      isnull(B.remarkaa,'') as remarkaa,
                      isnull(B.remarkbb,'') as remarkbb,
                      isnull(B.unsongnum, isnull(D.unsongnum,'')) as unsongnum,
                      B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime,  CONVERT(CHAR(19),B.misdatetime,20) as misdatetime
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                       LEFT JOIN as_jupsu D ON B.misdate = D.misdate and B.misnum = D.misnum
                  where    B.cltcd Like  #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')

                    AND Len(ISNULL(B.pernm,'')) > 0
                    and isnull(B.pcode,'') Like  #{pcode} + '%'
                  ORDER BY B.pernm, B.misdate, B.misnum, B.seq, B.fixdate
        ]]>

    </select>

    <select id="SelectDa024ListCltcd"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
                <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                                 B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                                 B.amt, C.acorp, pbonsa, pmodel, pcolor ,   B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                                 B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime
                   from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                   where  B.cltcd Like #{cltcd}
                     AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                     AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
                    AND B.fixdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    ORDER BY B.cltcd,  B.fixdate, B.misdate, B.misnum, B.seq
                ]]>

    </select>
<!--    {-->
<!--    call SP_SelectDa024ListCltcd(#{cltcd}, #{perid}, #{misgubun}, #{frdate}, #{todate}, #{fixflag}, #{makflag}, #{jpbgubn})-->
<!--    }-->


    <select id="SelectDa024ListCltcdGroup"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, count(*) as rownum, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum,
                        sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt,
                      sum(B.amt) as amt, B.acorp, B.pernm as inname, B.misgubun as misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                      max(isnull(B.remarkaa,'')) as remarkaa, max(isnull(B.remarkbb,'')) as remarkbb
                  from  TB_DA024 B WITH (NOLOCK)
                  where  B.cltcd Like #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.fixdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    AND Len(ISNULL(B.pernm,'')) > 0
                    and isnull(B.pcode,'') Like  #{pcode} + '%'
                  Group by B.cltcd,  B.pernm,   B.acorp, B.fixflag, B.misdate, B.misnum , B.misgubun
                  ORDER BY B.pernm, b.acorp, B.misdate, B.misnum,sum(B.qty ) desc
        ]]>

    </select>


    <select id="SelectDa024ListCltcdGroupJumun"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, count(*) as rownum,
                        sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt,
                      sum(B.amt) as amt, B.acorp, B.pernm as inname, max(B.misgubun) as misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm
                  from  TB_DA024 B WITH (NOLOCK)
                  where  B.cltcd Like #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    AND Len(ISNULL(B.pernm,'')) > 0
                    and isnull(B.pcode,'') Like  #{pcode} + '%'
                  Group by B.cltcd,  B.pernm,   B.acorp, B.fixflag
                  ORDER BY B.pernm, sum(B.qty ) desc, b.acorp
        ]]>

    </select>

    <select id="SelectDa024ListJpum"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                         B.amt, C.acorp, pbonsa, pmodel, pcolor , '' AS inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.fixdate,  CONVERT(CHAR(19),B.fixdatetime,20) as fixdatetime
           from  TB_DA024 B WITH (NOLOCK)
                 LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
           where    isnull(B.makflag, '0') = '1'
             AND isnull(B.pcode,'')  Like concat('%',#{pcode},'%')
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
            AND B.fixdate between #{frdate} and #{todate}
            AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
            and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
            ORDER BY B.pcode,  B.fixdate, B.misdate, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa024ListJpumGroup"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select    B.pcode, B.pname, B.psize, sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt,  count(*) as rownum,
                            sum(B.amt) as amt, B.acorp, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm
                  from  TB_DA024 B WITH (NOLOCK)
                  where  B.cltcd Like #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
                    AND B.fixdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                    AND Len(ISNULL(B.pernm,'')) > 0
                    and isnull(B.pcode,'') Like  #{pcode} + '%'
                  Group by B.cltcd, B.pcode, B.pname, B.psize, B.pernm, B.misgubun  , B.acorp, B.fixflag
                  ORDER BY  B.pernm, sum(B.qty ) desc
        ]]>

    </select>

    <select id="SelectDa024ListJpumGroupJumun"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select    B.pcode, B.pname, B.psize, sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt,  count(*) as rownum,
                            sum(B.amt) as amt, C.acorp, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm
                  from  TB_DA024 B WITH (NOLOCK)
                       LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
                  where  B.cltcd Like #{cltcd}
                    AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
                    AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                    AND Len(ISNULL(B.pernm,'')) > 0
                    and isnull(B.pcode,'') Like  #{pcode} + '%'
                  Group by B.cltcd, B.pcode, B.pname, B.psize, B.pernm, B.misgubun  , B.acorp, B.fixflag
                  ORDER BY  B.pernm, sum(B.qty ) desc
        ]]>

    </select>

    <select id="SelectDa024ListJpumArea"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select    count(*) as rownum, E.sidocd, E.sido, E.sidocd, B.pcode, B.pname, B.psize,
                            sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt, sum(B.amt) as amt
                  from  TB_DA024 B WITH (NOLOCK) ,
                      jcode3 F WITH (NOLOCK) ,
                      cif A WITH (NOLOCK)  Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid
                                           Left outer JOIN cif_sido e ON LEFT(A.apost1,3) = E.postcd
                  where  B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
                    AND B.pcode = F.jkey
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(F.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  Group by B.pcode, B.pname, B.psize,  E.sido, E.sidocd, F.jpb_gubn
                  ORDER BY E.sidocd, sum(B.qty ) desc, B.pname
        ]]>

    </select>

    <select id="SelectDa024ListJpumAreaGugun"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select    count(*) as rownum, E.sido,E.gugun, E.postcd, B.pcode, B.pname, B.psize,
                            sum(B.qty) as qty, sum(B.samt) as samt, sum(B.addamt) as addamt, sum(B.amt) as amt
                  from  TB_DA024 B WITH (NOLOCK) ,  cif_sido E WITH (NOLOCK),
                      jcode3 F WITH (NOLOCK),
                      cif A WITH (NOLOCK)  Left outer JOIN tb_xusers D ON A.abonsadam1 = D.perid
                  where  LEFT(A.apost1,3) = E.postcd
                    AND B.cltcd = A.acorp1 + CAST(A.acorp2 as varchar)
                    AND B.pcode = F.jkey
                    AND B.misdate between #{frdate} and #{todate}
                    AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
                    and isnull(F.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
                  Group by B.pcode, B.pname, B.psize,  E.sido, E.sidocd,E.gugun, E.postcd, F.jpb_gubn
                  ORDER BY E.sidocd, E.postcd, sum(B.qty ) desc, B.pname
        ]]>

    </select>



    <select id="SelectDa026ListPerid"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                         B.amt, C.acorp, pbonsa, pmodel, pcolor, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.omisdate, B.omisnum, B.oseq
           from  TB_DA026 B WITH (NOLOCK)
                 LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
           where  B.cltcd Like  #{cltcd}
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
            AND B.misdate between #{frdate} and #{todate}
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
             AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
             AND Isnull(B.pcode, '0') Like concat('%',#{pcode},'%')
            ORDER BY B.perid,  B.misdate, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa026ListCltcd"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                         B.amt, C.acorp, pbonsa, pmodel, pcolor, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.omisdate, B.omisnum, B.oseq
           from  TB_DA026 B WITH (NOLOCK)
                 LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
           where   B.cltcd Like  #{cltcd}
             AND isnull(B.perid,'')  Like concat('%',#{perid},'%')
            AND B.misdate between #{frdate} and #{todate}
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
             AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
             and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')
            ORDER BY B.cltcd,  B.misdate, B.misnum, B.seq
        ]]>

    </select>

    <select id="SelectDa026ListJpum"  parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="com.dae.eean.DTO.App01.IndexDa024Dto">
        <![CDATA[ select B.cltcd as cltcd, Left(B.misdate,4) + '-' + substring(B.misdate, 5,2)+ '-' + substring(B.misdate, 7,2) as misdate, B.misnum, B.seq,
                         B.pcode, B.pname, B.psize,    B.punit,  B.qty,  B.uamt, B.samt, B.addamt,
                         B.amt, C.acorp, pbonsa, pmodel, pcolor, B.pernm as inname, B.misgubun, isnull(B.fixflag,'0') as fixflag, B.pernm as pernm,
                         B.omisdate, B.omisnum, B.oseq
           from  TB_DA026 B WITH (NOLOCK)
                 LEFT JOIN cif C ON B.cltcd = C.acorp1 + CAST(C.acorp2 as varchar)
           where  B.cltcd Like  #{cltcd}
             AND isnull(B.pcode,'')  Like concat('%',#{pcode},'%')
            AND B.misdate between #{frdate} and #{todate}
             AND isnull(B.misgubun,'')  Like concat('%',#{misgubun},'%')
             AND Isnull(B.fixflag, '0') Like concat('%',#{fixflag},'%')
             AND Isnull(B.makflag, '0') Like concat('%',#{makflag},'%')
             and isnull(B.jpb_gubn,'') Like concat('%',#{jpbgubn},'%')

            ORDER BY B.pcode,  B.misdate, B.misnum, B.seq
        ]]>

    </select>


    <select id="SelectedFixDA024" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" resultType="String">
        SELECT seq FROM  tb_da024
        where misdate=#{misdate} and misnum=#{misnum} and  seq=#{seq} and cltcd = #{cltcd} and misgubun = #{misgubun} and len( isnull(CONVERT(CHAR(19),fixdatetime,20),'') ) = 0
    </select>

    <insert id="InsertDa023" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" >
        insert into TB_DA023 (custcd, spjangcd, cltcd, misgubun, misdate, misnum,
        contamt, gubun, yyyymm, perid, amt, addamt, misamt, billkind,
        taxcls, taxgubun, tax_spdate, tax_spnum, remark, bigo,
        spjangnum, delflag, ggubun, makflag) values
        ('EEAN', 'ZZ', #{cltcd}, #{misgubun}, #{misdate},    #{misnum},
         #{contamt}, #{gubun},    #{yyyymm},     #{perid},     #{amt},      #{addamt},  #{misamt},  #{billkind},
         #{taxcls},  #{taxgubun}, '', '', #{remark},   #{bigo},      #{spjangnum}, 'N', #{ggubun}, '0')
    </insert>

    <insert id="InsertDa025" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" >
        insert into TB_DA025 (custcd, spjangcd, cltcd, misgubun, misdate, misnum,
        contamt, gubun, yyyymm, perid, amt, addamt, misamt, billkind,
        taxcls, taxgubun, tax_spdate, tax_spnum, remark, bigo,
        spjangnum, delflag, ggubun, makflag  ) values
        ('EEAN', 'ZZ', #{cltcd}, #{misgubun}, #{misdate},    #{misnum},
        #{contamt}, #{gubun},    #{yyyymm},     #{perid},     #{amt},      #{addamt},  #{misamt},  #{billkind},
        #{taxcls},  #{taxgubun}, '', '', #{remark},   #{bigo},    #{spjangnum}, 'N' , #{ggubun}, '0' )
    </insert>


    <insert id="InsertDa024" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA024 (custcd, spjangcd, cltcd, misgubun, misdate, misnum, seq,
        pcode, pname, psize,    punit,  qty,  uamt, samt, addamt,
        amt, indate, inperid, pbonsa, pbonsa2, pmodel, pcolor, acorp, pernm, perid, jpb_gubn, userid, usernm  ) values
        ('EEAN', 'ZZ', #{cltcd},    #{misgubun}, #{misdate},  #{misnum}, #{seq},
        #{pcode}, #{pname}, #{psize}, #{punit}, #{qty},   #{uamt},  #{samt},  #{addamt},
        #{amt},  #{indate}, #{inperid} , #{pbonsa} , #{pbonsa2} , #{pmodel} , #{pcolor}, #{acorp}, #{pernm} , #{perid}, #{jpb_gubn}, #{userid}, #{usernm}   )
    </insert>

    <insert id="InsertDa024Jumsu" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA024 (custcd, spjangcd, cltcd, misgubun, misdate, misnum, seq,
        pcode, pname, psize,    punit,  qty,  uamt, samt, addamt,
        amt, indate, inperid, pbonsa, pbonsa2, pmodel, pcolor, acorp, pernm, perid, jpb_gubn, userid, usernm, makflag, misdatetime ,
        devflag, unsongnum) values
        ('EEAN', 'ZZ', #{cltcd},    #{misgubun}, #{misdate},  #{misnum}, #{seq},
        #{pcode}, #{pname}, #{psize}, #{punit}, #{qty},   #{uamt},  #{samt},  #{addamt},
        #{amt},  #{indate}, #{inperid} , #{pbonsa} , #{pbonsa2} , #{pmodel} , #{pcolor}, #{acorp}, #{pernm} , #{perid}, #{jpb_gubn}, #{userid}, #{usernm}, '1', getdate(),
        #{devflag},#{unsongnum} )
    </insert>


    <update id="UpdateDa024Jumsu" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto">
        update TB_DA024
        set custcd = 'EEAN'
        <if test="cltcd != null ">,</if>
        <if test="cltcd != null">cltcd=#{cltcd}</if>
        <if test="pcode != null ">,</if>
        <if test="pcode != null">pcode=#{pcode}</if>
        <if test="pname != null ">,</if>
        <if test="pname != null">pname=#{pname}</if>
        <if test="psize != null ">,</if>
        <if test="psize != null">psize=#{psize}</if>
        <if test="punit != null ">,</if>
        <if test="punit != null">punit=#{punit}</if>
        <if test="qty != null ">,</if>
        <if test="qty != null">qty=#{qty}</if>
        <if test="uamt != null ">,</if>
        <if test="uamt != null">uamt=#{uamt}</if>
        <if test="samt != null ">,</if>
        <if test="samt != null">samt=#{samt}</if>
        <if test="addamt != null ">,</if>
        <if test="addamt != null">addamt=#{addamt}</if>
        <if test="amt != null ">,</if>
        <if test="amt != null">amt=#{amt}</if>
        <if test="pbonsa != null ">,</if>
        <if test="pbonsa != null">pbonsa=#{pbonsa}</if>
        <if test="pbonsa2 != null ">,</if>
        <if test="pbonsa2 != null">pbonsa2=#{pbonsa2}</if>
        <if test="pcolor != null ">,</if>
        <if test="pcolor != null">pcolor=#{pcolor}</if>
        <if test="acorp != null ">,</if>
        <if test="acorp != null">acorp=#{acorp}</if>
        <if test="jpb_gubn != null ">,</if>
        <if test="jpb_gubn != null">jpb_gubn=#{jpb_gubn}</if>
        <if test="userid != null ">,</if>
        <if test="userid != null">userid=#{userid}</if>
        <if test="usernm != null ">,</if>
        <if test="usernm != null">usernm=#{usernm}</if>
        <if test="devflag != null ">,</if>
        <if test="devflag != null">devflag=#{devflag}</if>
        <if test="devdatetime != null ">,</if>
        <if test="devdatetime != null">devdatetime=#{devdatetime}</if>
        <if test="reservnum != null ">,</if>
        <if test="reservnum != null">reservnum=#{reservnum}</if>
        <if test="unsongnum != null ">,</if>
        <if test="unsongnum != null">unsongnum=#{unsongnum}</if>
        where misdate   = #{misdate} and misnum = #{misnum} and misgubun = #{misgubun}  and pmodel='AS'
    </update>



    <insert id="InsertDa026" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA026 (custcd, spjangcd, cltcd, misgubun, misdate, misnum, seq,
        pcode, pname, psize,    punit,  qty,  uamt, samt, addamt,
        amt, indate, inperid, pbonsa, pbonsa2, pmodel, pcolor , acorp, pernm, perid , jpb_gubn, userid, usernm ) values
        ('EEAN', 'ZZ', #{cltcd},   #{misgubun},  #{misdate},  #{misnum}, #{seq},
        #{pcode}, #{pname}, #{psize}, #{punit}, #{qty},   #{uamt},  #{samt},  #{addamt},
        #{amt},  #{indate}, #{inperid} , #{pbonsa} , #{pbonsa2} , #{pmodel} , #{pcolor}, #{acorp}, #{pernm}, #{perid}, #{jpb_gubn}, #{userid}, #{usernm}     )
    </insert>

    <insert id="InsertDa023Order" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA023 (custcd, spjangcd, cltcd, misgubun, misdate, misnum,
            contamt, gubun, yyyymm, perid, amt, addamt, misamt, billkind,
            taxcls, taxgubun, tax_spdate, tax_spnum, remark, bigo, vatemail, vatpernm,
            spjangnum, delflag, ggubun   , makflag )
        SELECT custcd, spjangcd, cltcd, misgubun, #{omisdate}, #{omisnum},
            contamt, gubun, yyyymm, perid, amt, addamt, misamt, billkind,
            taxcls, taxgubun, tax_spdate, tax_spnum, remark, bigo, vatemail, vatpernm,
            spjangnum, delflag, ggubun , '1'
        FROM TB_DA025 WHERE misdate = #{misdate} and misnum = #{misnum} and cltcd =#{cltcd}
    </insert>


    <insert id="InsertDa024Order" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        insert into TB_DA024 (custcd, spjangcd, cltcd, misgubun, misdate, misnum, seq,
            pcode, pname, psize,    punit,  qty,  uamt, samt, addamt,
            amt, indate, inperid, pbonsa, pbonsa2, pmodel, pcolor , remarkaa, remarkbb , makflag, acorp, pernm, perid, jpb_gubn )
        SELECT custcd, spjangcd, cltcd, misgubun, #{omisdate}, #{omisnum}, seq,
            pcode, pname, psize,    punit,  qty,  uamt, samt, addamt,
            amt, indate, inperid, pbonsa, pbonsa2, pmodel, pcolor, remarkaa, remarkbb , '1',  acorp, pernm, perid, jpb_gubn
        FROM TB_DA026 WHERE misdate=#{misdate} and misnum = #{misnum} and cltcd =#{cltcd}  and seq = #{seq}
    </insert>


    <insert id="InsertIa011" parameterType="com.dae.eean.DTO.App01.IndexIa011Dto" >
        insert into TB_IA011 (custcd, spjangcd, cltcd, spdate, spnum, suprice,taxamt,
            remarks, pubdate, booknum,    bookho,  serinum,  occuclafi, pubdatey, pubdatem, pubdated,
            artclnm1, artclnm2, artclnm3 , artclnm4,standard1, standard2, standard3, standard4,
            qty1, qty2, qty3, qty4, uprice1, uprice2, uprice3, uprice4, suprice1, suprice2, suprice3, suprice4,
            taxamt1, taxamt2, taxamt3, taxamt4, delflag,
            cltnm, prenm, saupnum, prenum, biztypenm, bisitemnm, zipcd, cltadres,
            taxmail, taxflag, misdate, misnum
        ) values
        (   'EEAN', 'ZZ', #{cltcd},   #{spdate},  #{spnum}, #{suprice}, #{taxamt},
            #{remarks}, #{pubdate}, #{booknum}, #{bookho}, #{serinum},   #{occuclafi},  #{pubdatey},  #{pubdatem}, #{pubdated},
            #{artclnm1},  #{artclnm2}, #{artclnm3} , #{artclnm4} , #{artclnm3} , #{standard1} , #{standard2} , #{standard3} , #{standard4},
            #{qty1} , #{qty2} , #{qty3} , #{qty4} , #{uprice1} , #{uprice2} , #{uprice3} , #{uprice4} ,
            #{suprice1}, #{suprice2}, #{suprice3}, #{suprice4}, #{taxamt1}, #{taxamt2}, #{taxamt3}, #{taxamt4}, #{delflag},
            #{cltnm}, #{prenm}, #{saupnum}, #{prenum}, #{biztypenm}, #{bisitemnm}, #{zipcd}, #{cltadres},
            #{taxmail}, #{taxflag}, #{misdate}, #{misnum}  )
    </insert>


    <insert id="InsertIa012" parameterType="com.dae.eean.DTO.App01.IndexIa012Dto" >
        insert into TB_IA012 (custcd, spjangcd, odnum, spdate, spnum, moday,
             artclnm, standard, qty,    uprice,  suprice,  taxamt, remarks  ) values
        (   'EEAN', 'ZZ', #{odnum},   #{spdate},  #{spnum}, #{moday},
             #{artclnm}, #{standard}, #{qty}, #{uprice}, #{suprice},   #{taxamt},  #{remarks}   )
    </insert>



    <delete id="DeleteDA023" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da023
        where misdate = #{misdate} and misnum = #{misnum} and cltcd = #{cltcd}
          and  (select count(*) as cnt  from tb_da024 with (NOLOCK) where misdate = #{misdate} and misnum=#{misnum} and misgubun = #{misgubun} and cltcd = #{cltcd} ) = 0
    </delete>

    <delete id="DeleteDA024" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da024
        where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq} and cltcd = #{cltcd}
    </delete>

    <delete id="DeleteDA024Jumsu" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da024
        where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq} and cltcd = #{cltcd} and pmodel='AS'
    </delete>

    <delete id="DeleteDA023Ord" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da023
        where  cltcd = #{cltcd}   and misdate = #{omisdate} and misnum=#{omisnum}
          and  (select count(*) as cnt  from tb_da024 with (NOLOCK) where misdate = #{omisdate} and misnum=#{omisnum} and misgubun = #{misgubun} and cltcd = #{cltcd} ) = 0
    </delete>

    <delete id="DeleteDA024Ord" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da024
        where  cltcd = #{cltcd}
          and  misdate + misnum + seq  = ( #{omisdate} + #{omisnum} + #{oseq} )
    </delete>


    <delete id="DeleteDA025" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da025
        where misdate = #{misdate} and misnum = #{misnum} and cltcd = #{cltcd}
          and misdate + misnum not in (select misdate + misnum from tb_da026 where misdate = #{misdate} and misnum=#{misnum} and misgubun = #{misgubun} and cltcd = #{cltcd} )
    </delete>

    <delete id="DeleteDA026" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da026
        where misdate = #{misdate} and misnum = #{misnum} and seq = #{seq} and cltcd = #{cltcd}
    </delete>


    <update id="UpdateDA023Unsong" parameterType="com.dae.eean.DTO.App01.IndexDa023Dto" >
        UPDATE tb_da024 SET
                            unsongnum=#{unsongnum} , reservnum =#{reservnum}
        where misdate=#{misdate} and misnum=#{misnum} and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA024rkaa" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da023 SET
        remarkaa=#{remarkaa} , makflag = '1'
        where misdate=#{misdate} and misnum=#{misnum}   and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA024rkbb" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da023 SET
        remarkbb=#{remarkbb} , makflag = '1'
        where misdate=#{misdate} and misnum=#{misnum} and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA024" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024 SET
        fixflag=#{fixflag}, fixdate=#{fixdate}, fixdatetime = getdate()
        where misdate=#{misdate} and misnum=#{misnum} and  seq=#{seq} and cltcd = #{cltcd} and misgubun = #{misgubun} and len( isnull(CONVERT(CHAR(19),fixdatetime,20),'') ) = 0
    </update>


    <update id="UpdateDA024Fix" parameterType="hashmap"   >
        UPDATE tb_da024 SET
               fixflag='1', fixdate=CONVERT(CHAR(8),getdate(),112), fixdatetime = getdate()
        where   misdate + misnum + seq + cltcd in
            <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">
                #{itemcd}
            </foreach>
        and len( isnull(CONVERT(CHAR(19),fixdatetime,20),'') ) = 0
    </update>

    <update id="UpdateDA024Dev" parameterType="hashmap">
        UPDATE tb_da024 SET
        devflag='1', devdatetime = getdate()
        where   misdate + misnum + seq + cltcd in
        <foreach collection="itemcdArr" item="itemcd"  open="(" close=")" separator=",">
            #{itemcd}
        </foreach>
        and len( isnull(CONVERT(CHAR(19),devdatetime,20),'') ) = 0
    </update>

    <update id="UpdateDA024Qty" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024 SET
          qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt},   makflag = '1', misdatetime = getdate(),  remarkaa=#{remarkaa}, remarkbb=#{remarkbb}, userid=#{userid}, usernm=#{usernm}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq}
    </update>

    <update id="UpdateDA024QtySame" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024 SET
                qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt}, userid=#{userid}, usernm=#{usernm}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq}
    </update>

    <update id="UpdateDA024Amt" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024 SET
                            qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt}, uamt=#{uamt}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq}
    </update>


    <update id="UpdateDA024Remk" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024 SET remarkaa=#{remarkaa}, remarkbb=#{remarkbb}
        where misdate=#{misdate} and misnum=#{misnum} and misgubun = #{misgubun}
    </update>


    <update id="UpdateDA024Del" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da024_del SET deluserid=#{deluserid}, deluser=#{deluser}
        where misdate=#{misdate} and misnum=#{misnum} and seq = #{seq}
    </update>


    <delete id="DeleteDA024Mkflag" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da024
        where  misdate =#{misdate} and misnum =  #{misnum} and seq  =  #{seq}
    </delete>


    <delete id="DeleteDA026Mkflag" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        delete from tb_da026
        where  cltcd = #{cltcd}
        and  misdate + misnum + seq  = ( #{misdate} + #{misnum} + #{seq} )
    </delete>

    <update id="UpdateDA026" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da026 SET
        fixflag=#{fixflag}, omisdate=#{omisdate}, omisnum=#{omisnum}, oseq=#{oseq}
        where misdate=#{misdate} and misnum=#{misnum} and  seq=#{seq} and cltcd = #{cltcd} and misgubun = #{misgubun}
    </update>


    <update id="UpdateDA026Del" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da026_del SET  deluserid=#{deluserid}, deluser=#{deluser}
        where misdate=#{misdate} and misnum=#{misnum} and  seq=#{seq} and cltcd = #{cltcd}
    </update>


    <update id="UpdateDA026QtySame" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da026 SET
                            qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq} and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA026rkaa" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da025 SET
        remarkaa=#{remarkaa} , makflag = '1'
        where misdate=#{misdate} and misnum=#{misnum}  and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA026rkbb" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da025 SET
        remarkbb=#{remarkbb}, makflag = '1'
        where misdate=#{misdate} and misnum=#{misnum}  and cltcd = #{cltcd}
    </update>

    <update id="UpdateDA026Qty" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da026 SET
            qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt},   makflag = '1', misdatetime = getdate(),  remarkaa=#{remarkaa}, remarkbb=#{remarkbb}, userid=#{userid},usernm=#{usernm}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq} and cltcd = #{cltcd}
    </update>


    <update id="UpdateDA026Amt" parameterType="com.dae.eean.DTO.App01.IndexDa024Dto" >
        UPDATE tb_da026 SET
                            qty=#{qty}, samt=#{samt}, addamt=#{addamt}, amt=#{amt},  uamt=#{uamt}
        where misdate=#{misdate} and misnum=#{misnum} and seq=#{seq} and cltcd = #{cltcd}
    </update>



</mapper>
